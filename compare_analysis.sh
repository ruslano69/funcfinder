#!/bin/bash

echo "========================================="
echo "–°–†–ê–í–ù–ï–ù–ò–ï: grep vs funcfinder"
echo "–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã funcfinder"
echo "========================================="
echo ""

# –ó–∞–¥–∞—á–∞ 1: –°–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ FindFunctions?
echo "üìä –ó–∞–¥–∞—á–∞ 1: –£–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ FindFunctions"
echo "----------------------------------------"
echo "grep: –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å—á–∏—Ç–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –º–µ–∂–¥—É –æ–±—ä—è–≤–ª–µ–Ω–∏–µ–º –∏ –∫–æ–Ω—Ü–æ–º"
grep -n "^func.*FindFunctions" finder.go | head -1
echo "(–Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –∑–∞–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É –≤—Ä—É—á–Ω—É—é...)"
echo ""

echo "funcfinder: —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã"
./funcfinder --inp finder.go --source go --func FindFunctions
echo ""

# –ó–∞–¥–∞—á–∞ 2: –ò–∑–≤–ª–µ—á—å —Ç–µ–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏
echo "üì§ –ó–∞–¥–∞—á–∞ 2: –ò–∑–≤–ª–µ—á—å —Ç–µ–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏ ParseFuncNames"
echo "----------------------------------------"
echo "grep: –Ω—É–∂–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å sed/awk"
echo "$ grep -A 100 'func ParseFuncNames' finder.go | ..."
echo "(—Å–ª–æ–∂–Ω–æ –∏ –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ)"
echo ""

echo "funcfinder: –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞"
./funcfinder --inp finder.go --source go --func ParseFuncNames --extract | head -10
echo "..."
echo ""

# –ó–∞–¥–∞—á–∞ 3: –ü–æ–ª—É—á–∏—Ç—å JSON –¥–ª—è AI
echo "ü§ñ –ó–∞–¥–∞—á–∞ 3: –ü–æ–ª—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è AI (JSON)"
echo "----------------------------------------"
echo "grep: –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞"
echo ""

echo "funcfinder: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ JSON"
./funcfinder --inp finder.go --source go --map --json
echo ""

# –ó–∞–¥–∞—á–∞ 4: –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö Go —Ñ–∞–π–ª–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ
echo "üìÅ –ó–∞–¥–∞—á–∞ 4: –°–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π –≤ –∫–∞–∂–¥–æ–º .go —Ñ–∞–π–ª–µ?"
echo "----------------------------------------"
echo "grep: –Ω—É–∂–µ–Ω —Ü–∏–∫–ª + –ø–æ–¥—Å—á–µ—Ç"
for file in *.go; do
    count=$(grep -c "^func " "$file" 2>/dev/null || echo 0)
    echo "grep: $file - $count —Ñ—É–Ω–∫—Ü–∏–π"
done
echo ""

echo "funcfinder: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏"
for file in *.go; do
    result=$(./funcfinder --inp "$file" --source go --map 2>/dev/null)
    if [ -n "$result" ]; then
        count=$(echo "$result" | grep -o ';' | wc -l)
        echo "funcfinder: $file - $count —Ñ—É–Ω–∫—Ü–∏–π"
    fi
done
echo ""

# –ó–∞–¥–∞—á–∞ 5: –ù–∞–π—Ç–∏ —Å–∞–º—É—é –±–æ–ª—å—à—É—é —Ñ—É–Ω–∫—Ü–∏—é
echo "üìè –ó–∞–¥–∞—á–∞ 5: –ö–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è?"
echo "----------------------------------------"
echo "grep: –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ, –Ω—É–∂–µ–Ω –±–æ–ª—å—à–æ–π —Å–∫—Ä–∏–ø—Ç"
echo ""

echo "funcfinder: –∏—Å–ø–æ–ª—å–∑—É–µ–º JSON + jq"
./funcfinder --inp finder.go --source go --map --json | \
    jq -r 'to_entries[] | "\(.key): \(.value.end - .value.start) lines"' | \
    sort -t: -k2 -rn | head -3
echo ""

echo "========================================="
echo "–í–´–í–û–î:"
echo "grep: –±—ã—Å—Ç—Ä—ã–π, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã"
echo "funcfinder: —Ç–æ—á–Ω—ã–π, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, AI-ready"
echo "========================================="
